Finished stage 1 (very slow though).

Will need to switch to depth-first then ensure global optimum.
